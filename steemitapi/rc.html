<html>
<head>
<script src="https://github.com/steemit/steem-js/releases/download/v0.7.7/steem.min.js"></script>
</head>
<body>
<script>
steem.api.setOptions({url: 'https://api.steemit.com'})
async function clickBtn(){
//capture account
        let username = document.getElementById("username").value;
var _account = await steem.api.getAccountsAsync([username])
var account = _account[0]
var props = await steem.api.getDynamicGlobalPropertiesAsync()
var CURRENT_UNIX_TIMESTAMP = parseInt((new Date(props.time+"Z").getTime() / 1000).toFixed(0))//

//calculate available SP
var totalShares = parseFloat(account.vesting_shares) + parseFloat(account.received_vesting_shares) - parseFloat(account.delegated_vesting_shares);
        
//determine elapsed time since last RC update
var elapsed = CURRENT_UNIX_TIMESTAMP - account.voting_manabar.last_update_time;
        
var maxMana = totalShares * 1000000;
//calculate current mana for the 5 day period (432000 sec = 5 days)
var currentMana = parseFloat(account.voting_manabar.current_mana) + elapsed * maxMana / 432000;

if (currentMana > maxMana) {
    currentMana = maxMana;
}
//determine percentage of available mana(RC)
var currentManaPerc = currentMana * 100 / maxMana;
    
console.log(currentManaPerc);

        document.getElementById("maxMana").innerText = maxMana.toFixed(3);
        document.getElementById("currentMana").innerText = currentMana.toFixed(3);
        document.getElementById("currentManaPerc").innerText = currentManaPerc.toFixed(3)+'%';
}    
</script>
                <p>アカウント名を入力してください。</p>
        <input type="text" id="username" cols="20" value=yasu />
                <input type="button" value="RCを表示する" onclick="clickBtn()" /><a id="progress"></a>

<br/>
<br/>
<b>totalShares: </b><a id=maxMana></a>
<br/>
vesting_shares + received_vesting_shares - delegated_vesting_shares
<br/>
<br/>
        
<b>currentMana: </b><a id=currentMana></a>
voting_manabar.current_mana + elapsed * maxMana / 432000

        
        <p id=currentManaPerc></p>
</body>
</html>
