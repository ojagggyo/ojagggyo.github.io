<!doctype html>
<html lang="en">
    <head>
        <title>SBD Debt Ratio</title>
        <meta charset="utf-8">
        <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
        <script src="https://github.com/steemit/steem-js/releases/download/v0.7.7/steem.min.js"></script>
        
        <script>            

            steem.api.setOptions({url: 'https://api.steemit.com'});

            async function getDynamicGlobalPropertiesxxx(){
                let result = await steem.api.getDynamicGlobalPropertiesAsync();
                console.log('getDynamicGlobalProperties');
                console.log(result);
                return result;
            }

            async function getCurrentMedianHistoryPricexxx(){
                let result = await steem.api.getCurrentMedianHistoryPriceAsync();
                console.log('getCurrentMedianHistoryPrice');
                console.log(result);
                return result;
            }
          
            async function main(){
                let a = getDynamicGlobalPropertiesxxx();
                let current_sbd_supply = parseFloat(a.current_sbd_supply);
                console.log(current_sbd_supply);
                let virtual_supply = parseFloat(a.virtual_supply);
                console.log(virtual_supply);
                let b = getCurrentMedianHistoryPricexxx();
                let base = parseFloat(b.base);
                let quote = parseFloat(b.quote);
                let steem_price = base / quote;
                console.log(steem_price);
                $("#text").text(current_sbd_supply * 100 / (virtual_supply * steem_price));
            }

            window.onload = function() {
                main();
            };
        </script>
    </head>
    <body>
        <h1 id="text"></h1>
    </body>
</html>
