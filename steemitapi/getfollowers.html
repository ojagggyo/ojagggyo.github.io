<!doctype html>
<html lang="en">
    <head>
        <title>getfollowers</title>
        <meta charset="utf-8">
        <script src="https://github.com/steemit/steem-js/releases/download/v0.7.7/steem.min.js"></script>
        <!-- <script src="https://ojagggyo.github.io/steemitapi/getfollowers.js"></script> -->
        
        <script>
        

    	
	
	client = steem.api.setOptions({url: 'https://api.steemit.com'})
	
async function aaa(){
	let out = [];
	let limit = 10;
	let lastUser = "";
	let author = document.getElementById("text1").value;
	while (limit == 10 && out.length < 50){
		//let ret = await steem.api.getTrendingTagsAsync(lastTag, limit);
		let ret = await steem.api.getFollowersAsync(author, lastUser, 'blog', limit);
		console.log(ret);
		limit = ret.length;
		lastUser = ret[ret.length - 1].follower;
		out.pop();
		out = out.concat(ret);
	}
	console.log("☆");
	console.log(out);

	return out;
};
	
aaa().then(result => {
	console.log('☆result☆');
	console.log(result);
	html = '<table border=1 >';
	//テーブルのヘッダー
	html = html + '<tr>';
	html = html + '<th></th><th>Name</th>';
	html = html + '</tr>';
	for(var i=0;i<result.length;i=i+1){
		html = html + '<tr>';
		html = html + '<td align=right>' + (i+1) + '</td>';
		html = html + '<td>' + result[i].follower + '</td>';
		html = html + '</tr>';
	}
	html = html + '</table>';
	console.log(html);
	document.getElementById("text").innerHTML = html;
	}).catch(err => {
	console.log('☆');
	console.log(err);
});
		
		
	function clickBtn(){;
		aaa().then(result => {		
			makeTable(result);
		}).catch(err => {
			console.log('☆');
			console.log(err);
		});
	}

		
        </script>
        
    </head>
    <body>        
        <p>フォローワを表示します。</p>
	<input type="text" id="text1" size="20" value=yasu> <input type="button" value="表示する" onclick="clickBtn()" />
	<a id="progress"></a>
        <br/>
        <span id="text"></span>
    </body>
</html>
