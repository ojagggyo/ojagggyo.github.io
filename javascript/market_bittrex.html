<html lang="en">
<head>
  <meta charset="utf-8">
  <title>jQuery.getJSON</title>
  <script src="https://code.jquery.com/jquery-3.5.0.js"></script>
</head>
<body>
  
<script>
	
//markets
//BTC-STEEM
//BTC-SBD
function getPrice(markets) {
	return new Promise((resolve) => {
		//let url = "https://api.upbit.com/v1/ticker?markets=" + markets;
		let url = "https://api.bittrex.com/api/v1.1/public/getticker?market=" + markets;
		//$.getJSON(url, (data) => {
		//	resolve(data[0].trade_price);
		//});
		$.ajax({
		    beforeSend: function(request) {
			request.setRequestHeader("user-agent", 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/96.0.4664.93 Safari/537.36');
		    },
		    dataType: "json",
		    url: url,
		    success: function(data) {
			resolve(data[0].trade_price);
		    },
		    error: function () {
			alert("失敗");
		    }
		});
	});
};

async function rate(){
	const steem = await getPrice('BTC-STEEM');
	const sbd = await getPrice('BTC-SBD');
	return {'steem': steem, 'sbd': sbd, 'rate': sbd / steem};
};
	
	
rate().then(result => {
	$("#steem").html(result['steem']);
	$("#sbd").html(result['sbd']);
	$("#rate").html(result['rate'].toFixed(2));
}).catch(err => {
	console.log(err);
});
	
</script>

<h1>STEEM価格</h1>
<b id="steem"></b>BTC (bittrex取引所)
<br/>
<b id="sbd"></b>BTC (bittrex取引所)
<br/>
レート <b id="rate"></b>

</body>
</html>
